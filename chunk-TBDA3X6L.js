import{a as z,b as O}from"./chunk-EL3TMZM7.js";import"./chunk-VTMQXDHM.js";import{a as A}from"./chunk-A5UL2CMB.js";import{d as P,k as N}from"./chunk-7UPRQAP3.js";import{k as F,l as R,m as U,n as j}from"./chunk-ARZNZIPW.js";import{Db as r,Eb as c,Fb as y,Kb as E,Lb as T,Ma as I,Mb as M,Pa as o,Ua as h,X as C,Za as k,ca as u,cb as b,da as m,ea as f,fa as S,jb as x,mb as D,nb as V,ob as t,pb as i,qb as v,rb as g,ub as p,vb as s}from"./chunk-5ON5RGEH.js";var L=(d,n,e)=>({"bg-yellow-200 text-yellow-800":d,"bg-blue-200 text-blue-800":n,"bg-red-50 text-red-800":e}),H=(d,n)=>n.id;function B(d,n){if(d&1){let e=g();t(0,"tr",8)(1,"td",10),r(2),i(),t(3,"td",11),r(4),i(),t(5,"td",12)(6,"span",13),r(7),i()(),t(8,"td",11),r(9),i(),t(10,"td",11),r(11),i(),t(12,"td",14),r(13),i(),t(14,"td",15)(15,"div",16)(16,"button",17),p("click",function(){let l=u(e).$implicit,_=s();return m(_.verDetalles(l,l.rutaOficioJuzgado))}),f(),t(17,"svg",18),v(18,"path",19),i(),r(19," Ver Detalles "),i(),S(),t(20,"button",20),p("click",function(){let l=u(e).$implicit,_=s();return m(_.verRegistro(l))}),f(),t(21,"svg",18),v(22,"path",19),i(),r(23," Responder "),i()()()()}if(d&2){let e=n.$implicit;o(2),c(e.codigoSolicitud),o(2),c(e.demandado),o(2),x("ngClass",E(7,L,e.estado==="PENDIENTE",e.estado=="ATENDIDO",e.estado!=="ATENDIDO")),o(),y(" ",e.estado," "),o(2),c(e.expediente),o(2),c(e.fechaEmision),o(2),c(e.observacion)}}function G(d,n){if(d&1&&v(0,"iframe",42),d&2){let e=s(2);x("src",e.pdfUrl,I)}}function $(d,n){d&1&&(t(0,"div",43),r(1," No hay documento para mostrar "),i())}function J(d,n){if(d&1){let e=g();t(0,"div",21),p("click",function(){u(e);let l=s();return m(l.cerrarModalDetalles())}),t(1,"div",22),p("click",function(l){return u(e),m(l.stopPropagation())}),t(2,"div",23)(3,"h3",24),r(4,"Detalles de la Solicitud"),i(),t(5,"button",25),p("click",function(){u(e);let l=s();return m(l.cerrarModalDetalles())}),f(),t(6,"svg",26),v(7,"path",27),i()()(),S(),t(8,"div",28)(9,"div",29)(10,"div",30)(11,"div")(12,"label",31),r(13,"C\xF3digo:"),i(),t(14,"p",32),r(15),i()(),t(16,"div")(17,"label",31),r(18,"Demandado:"),i(),t(19,"p",32),r(20),i()(),t(21,"div")(22,"label",31),r(23,"Estado:"),i(),t(24,"span",33),r(25),i()(),t(26,"div")(27,"label",31),r(28,"Expediente:"),i(),t(29,"p",32),r(30),i()(),t(31,"div")(32,"label",31),r(33,"Fecha de Solicitud:"),i(),t(34,"p",32),r(35),T(36,"date"),i()(),t(37,"div")(38,"label",31),r(39,"Juzgado:"),i(),t(40,"p",32),r(41),i()(),t(42,"div")(43,"label",31),r(44,"Archivo Adjunto:"),i(),t(45,"button",34),p("click",function(){u(e);let l=s();return m(l.verOficio(l.selectedSolicitud==null?null:l.selectedSolicitud.rutaOficioJuzgado))}),r(46," Ver Documento "),i()()(),t(47,"div",35)(48,"label",31),r(49,"Observaciones:"),i(),t(50,"p",36),r(51),i()()(),t(52,"div",37),b(53,G,1,1,"iframe",38)(54,$,2,0,"div",39),i()(),t(55,"div",40)(56,"button",41),p("click",function(){u(e);let l=s();return m(l.cerrarModalDetalles())}),r(57," Cerrar "),i()()()()}if(d&2){let e=s();o(15),c(e.selectedSolicitud==null?null:e.selectedSolicitud.codigoSolicitud),o(5),c(e.selectedSolicitud==null?null:e.selectedSolicitud.demandado),o(4),x("ngClass",E(13,L,(e.selectedSolicitud==null?null:e.selectedSolicitud.estado)==="PENDIENTE",(e.selectedSolicitud==null?null:e.selectedSolicitud.estado)==="ATENDIDO",(e.selectedSolicitud==null?null:e.selectedSolicitud.estado)!=="ATENDIDO")),o(),y(" ",e.selectedSolicitud==null?null:e.selectedSolicitud.estado," "),o(5),c(e.selectedSolicitud==null?null:e.selectedSolicitud.expediente),o(5),c(M(36,10,e.selectedSolicitud==null?null:e.selectedSolicitud.fechaEmision,"dd/MM/yyyy")),o(6),c(e.selectedSolicitud==null?null:e.selectedSolicitud.juzgado),o(10),c(e.selectedSolicitud==null?null:e.selectedSolicitud.observacion),o(2),x("ngIf",e.pdfUrl),o(),x("ngIf",!e.pdfUrl)}}function q(d,n){if(d&1){let e=g();t(0,"div",21),p("click",function(){u(e);let l=s();return m(l.cerrarModal())}),t(1,"div",22),p("click",function(l){return u(e),m(l.stopPropagation())}),t(2,"div",23)(3,"h3",24),r(4,"Registro de Nueva Cuenta"),i(),t(5,"button",25),p("click",function(){u(e);let l=s();return m(l.cerrarModal())}),f(),t(6,"svg",26),v(7,"path",27),i()()(),S(),v(8,"app-registrar",44),i()()}if(d&2){let e=s();o(8),x("solicitud",e.selectedSolicitud)}}var w=class d{constructor(n,e){this.ftpService=n;this.sanitizer=e}solicitudesService=C(z);solicitudes=[];pdfUrl=null;mostrarModal=!1;mostrarModalDetalles=!1;selectedSolicitud=null;documentUrl=null;cuenta={numeroCuenta:"",numeroCCI:"",comentario:"",documentoRespuesta:null};solicitud={estado:"PENDIENTE"};ngOnInit(){this.cargarSolicitudes()}cargarSolicitudes(){this.solicitudesService.list().subscribe({next:n=>{this.solicitudes=n},error:n=>console.error("Error al cargar solicitudes:",n)})}verOficio(n){window.open(n,"_blank")}verPdf(n){if(!n){this.pdfUrl=null;return}this.ftpService.downloadFile(n).subscribe({next:e=>this.mostrarPdfEnIframe(e),error:e=>this.manejarErrorDescarga(e)})}mostrarPdfEnIframe(n){let e=URL.createObjectURL(n);this.pdfUrl=this.sanitizer.bypassSecurityTrustResourceUrl(e)}manejarErrorDescarga(n){console.error("Error al descargar el archivo:",n.message),alert(n.message),this.pdfUrl=null}verDetalles(n,e){this.selectedSolicitud=n,this.mostrarModalDetalles=!0,this.ftpService.downloadFile(e).subscribe({next:a=>this.mostrarPdfEnIframe(a),error:a=>console.error("Error al descargar el archivo:",a)})}cerrarModalDetalles(){this.mostrarModalDetalles=!1,this.resetearPdf()}resetearPdf(){this.pdfUrl=null,this.selectedSolicitud=null}verRegistro(n){this.mostrarModal=!0,this.selectedSolicitud=n,this.resetearFormularioCuenta()}cerrarModal(){this.mostrarModal=!1,this.resetearFormularioCuenta(),this.documentUrl=null}resetearFormularioCuenta(){this.cuenta={numeroCuenta:"",numeroCCI:"",comentario:"",documentoRespuesta:null}}onFileSelected(n){let e=n.target;if(e.files&&e.files.length>0){let a=e.files[0];this.procesarArchivoSeleccionado(a)}}procesarArchivoSeleccionado(n){n.type==="application/pdf"?(this.cuenta.documentoRespuesta=n,this.previsualizarPdf(n)):(alert("Por favor, seleccione un archivo PDF v\xE1lido"),this.cuenta.documentoRespuesta=null,this.documentUrl=null)}previsualizarPdf(n){let e=new FileReader;e.onload=a=>{this.documentUrl=a.target.result},e.readAsDataURL(n)}onSubmit(){this.validarCuenta()&&console.log("Datos de la cuenta:",this.cuenta)}validarCuenta(){return!!(this.cuenta.numeroCuenta&&this.cuenta.numeroCCI&&this.cuenta.comentario)}static \u0275fac=function(e){return new(e||d)(h(A),h(P))};static \u0275cmp=k({type:d,selectors:[["app-solicitudes"]],decls:26,vars:2,consts:[[1,"p-6","bg-white","rounded-lg","shadow-md"],[1,"text-3xl","font-semibold","text-gray-800","mb-6"],[1,"overflow-x-auto","rounded-lg","border","border-gray-200"],[1,"min-w-full","divide-y","divide-gray-200"],[1,"bg-gray-50"],[1,"px-6","py-3","text-left","text-xs","font-bold","text-gray-500","uppercase","tracking-wider"],[1,"px-6","py-3","text-center","text-xs","font-bold","text-gray-500","uppercase","tracking-wider"],[1,"bg-white","divide-y","divide-gray-200"],[1,"hover:bg-gray-50","transition-colors"],["class","fixed inset-0 z-50 flex items-center justify-center bg-gray-50/75",3,"click",4,"ngIf"],[1,"px-6","py-4","whitespace-nowrap","text-sm","text-gray-700","font-medium"],[1,"px-6","py-4","whitespace-nowrap","text-sm","text-gray-600"],[1,"px-6","py-4","whitespace-nowrap"],[1,"px-3","py-1","inline-flex","text-xs","leading-5","font-semibold","rounded-full",3,"ngClass"],[1,"px-6","py-4","text-sm","text-gray-600","max-w-xs"],[1,"px-2","py-4","whitespace-nowrap"],[1,"flex","justify-center","items-center","gap-2"],[1,"inline-flex","items-center","px-4","py-2","border","border-transparent","text-sm","font-medium","rounded-md","text-white","bg-[#c03535]","hover:bg-[#bd6969]",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","mr-2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"],[1,"inline-flex","items-center","px-4","py-2","border","border-transparent","text-sm","font-medium","rounded-md","text-white","bg-[#1648b6]","hover:bg-[#23203a]",3,"click"],[1,"fixed","inset-0","z-50","flex","items-center","justify-center","bg-gray-50/75",3,"click"],[1,"bg-white","rounded-lg","shadow-2xl","w-full","max-w-5xl","h-[90vh]","mx-4",3,"click"],[1,"flex","justify-between","items-center","p-4","border-b","border-gray-200"],[1,"text-xl","font-semibold","text-gray-800"],[1,"text-gray-500","hover:text-gray-700",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],[1,"flex","h-[calc(90vh-100px)]"],[1,"w-1/3","p-6","space-y-4","overflow-auto","border-r","border-gray-200"],[1,"space-y-3"],[1,"block","text-sm","font-medium","text-gray-600"],[1,"mt-1","text-gray-900"],[1,"mt-1","px-3","py-1","inline-flex","text-xs","leading-5","font-semibold","rounded-full",3,"ngClass"],[1,"mt-1","inline-flex","items-center","px-3","py-1.5","border","border-transparent","text-xs","font-medium","rounded-md","text-white","bg-[#c52424]","hover:bg-[#6d3b3b]",3,"click"],[1,"mt-4"],[1,"mt-1","text-gray-900","whitespace-pre-wrap"],[1,"w-2/3","p-4"],["class","w-full h-full border rounded-lg","allowfullscreen","",3,"src",4,"ngIf"],["class","flex items-center justify-center h-full text-gray-500",4,"ngIf"],[1,"p-4","border-t","border-gray-200","flex","justify-end","space-x-3"],[1,"px-4","py-2","border","border-gray-300","rounded-md","text-gray-700","hover:bg-gray-50",3,"click"],["allowfullscreen","",1,"w-full","h-full","border","rounded-lg",3,"src"],[1,"flex","items-center","justify-center","h-full","text-gray-500"],[3,"solicitud"]],template:function(e,a){e&1&&(t(0,"div",0)(1,"h2",1),r(2,"Solicitudes"),i(),t(3,"div",2)(4,"table",3)(5,"thead",4)(6,"tr")(7,"th",5),r(8,"C\xF3digo"),i(),t(9,"th",5),r(10,"Demandado"),i(),t(11,"th",5),r(12,"Estado"),i(),t(13,"th",5),r(14,"Expediente"),i(),t(15,"th",5),r(16,"Fecha Solicitud"),i(),t(17,"th",5),r(18,"Observaciones"),i(),t(19,"th",6),r(20,"Acciones"),i()()(),t(21,"tbody",7),D(22,B,24,11,"tr",8,H),i()()()(),b(24,J,58,17,"div",9)(25,q,9,1,"div",9)),e&2&&(o(22),V(a.solicitudes),o(2),x("ngIf",a.mostrarModalDetalles),o(),x("ngIf",a.mostrarModal))},dependencies:[j,F,R,U,N,O],encapsulation:2})};export{w as default};
