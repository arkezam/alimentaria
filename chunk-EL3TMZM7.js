import{a as O,b as z,c as Q,d as $,e as G,f as K,g as U,i as J,j as X,k as Z}from"./chunk-VTMQXDHM.js";import{a as R,c as H,l as W,n as I}from"./chunk-7UPRQAP3.js";import{l as j,n as B}from"./chunk-ARZNZIPW.js";import{Ab as q,Bb as L,Cb as p,Db as a,Fb as M,Gb as b,Hb as y,Ib as S,Pa as s,R as N,Ua as k,X as F,Za as V,ca as f,cb as c,da as g,e as Y,ea as T,jb as m,kb as v,ob as i,pb as o,qb as C,rb as D,ub as x,vb as _,zb as P}from"./chunk-5ON5RGEH.js";var E=class e{http=F(H);cookieService=F(W);COOKIE_NAME="authToken";getAuthHeaders(){let r=this.cookieService.get(this.COOKIE_NAME);return new R({Authorization:`Bearer ${r}`})}list(){return this.http.get(`${I}/solicitudes/listar`,{headers:this.getAuthHeaders()})}get(r){return this.http.get(`${I}/solicitudes/${r}`,{headers:this.getAuthHeaders()})}actualizarSolicitud(r,t){let n=new R({Authorization:`Bearer ${this.cookieService.get("authToken")}`});return this.http.put(`${I}/solicitudes/${r}/atender`,t,{headers:n,responseType:"text"})}static \u0275fac=function(t){return new(t||e)};static \u0275prov=N({token:e,factory:e.\u0275fac,providedIn:"root"})};var w=Y(Z());var ie=["fileInput"];function ne(e,r){e&1&&(i(0,"span"),a(1,"Campo requerido"),o())}function re(e,r){e&1&&(i(0,"span"),a(1,"Debe contener 13 caracteres v\xE1lidos (N\xFAmeros y guiones)"),o())}function oe(e,r){if(e&1&&(i(0,"div",24),c(1,ne,2,0,"span",23)(2,re,2,0,"span",23),o()),e&2){_();let t=p(12);s(),m("ngIf",t.errors==null?null:t.errors.required),s(),m("ngIf",t.errors==null?null:t.errors.pattern)}}function ae(e,r){e&1&&(i(0,"span"),a(1,"Campo requerido"),o())}function le(e,r){e&1&&(i(0,"span"),a(1,"Debe contener entre 13 a 25 caracteres v\xE1lidos (N\xFAmeros y guiones)"),o())}function se(e,r){if(e&1&&(i(0,"div",24),c(1,ae,2,0,"span",23)(2,le,2,0,"span",23),o()),e&2){_();let t=p(20);s(),m("ngIf",t.errors==null?null:t.errors.required),s(),m("ngIf",t.errors==null?null:t.errors.pattern)}}function me(e,r){e&1&&(i(0,"span"),a(1,"Campo requerido"),o())}function de(e,r){if(e&1&&(i(0,"div",24),c(1,me,2,0,"span",23),o()),e&2){_();let t=p(28);s(),m("ngIf",t.errors==null?null:t.errors.required)}}function ue(e,r){e&1&&(i(0,"p",25),C(1,"i",26),a(2,"Solo se permiten archivos PDF "),o())}function ce(e,r){if(e&1&&(i(0,"p",27),C(1,"i",28),a(2),o()),e&2){let t=_();s(2),M("Archivo seleccionado: ",t.selectedFileName," ")}}function pe(e,r){e&1&&(i(0,"p",25),C(1,"i",26),a(2,"Debe seleccionar el documento de respuesta "),o())}function fe(e,r){e&1&&(i(0,"span"),T(),i(1,"svg",29),C(2,"path",30),o(),a(3," Registrar Cuenta "),o())}function ge(e,r){e&1&&(i(0,"span"),C(1,"i",31),a(2," Procesando... "),o())}var A=class e{constructor(r){this.solicitudService=r}fileInput;solicitud;fileError=!1;selectedFileName=null;selectedFile=null;isLoading=!1;cuenta={numeroCuenta:"",numeroCCI:"",comentario:""};onSubmit(r){if(r.invalid||!this.selectedFile||!this.solicitud?.id){w.default.fire({title:"Error",text:"Por favor complete todos los campos requeridos",icon:"warning",confirmButtonColor:"#8F0202"});return}let t=new FormData;t.append("numeroCCI",this.cuenta.numeroCCI),t.append("estado","ATENDIDO"),t.append("comentario",this.cuenta.comentario),t.append("file",this.selectedFile),this.isLoading=!0,this.solicitudService.actualizarSolicitud(this.solicitud.id,t).subscribe({next:n=>{w.default.fire({title:"Documento Enviado!",text:"Cuenta registrada correctamente",icon:"success",confirmButtonColor:"#f79757"}),this.resetForm(r)},error:n=>{w.default.fire("Error","Ocurri\xF3 un error al registrar la cuenta","error"),console.error("Error:",n)},complete:()=>{this.isLoading=!1}})}resetForm(r){r.resetForm(),this.cuenta={numeroCuenta:"",numeroCCI:"",comentario:""},this.selectedFile=null,this.selectedFileName=null,this.fileInput.nativeElement.value=""}triggerFileInput(){this.fileInput.nativeElement.click()}onFileChange(r){let t=r.target;if(t.files&&t.files.length>0){let n=t.files[0];n.type==="application/pdf"?(this.fileError=!1,this.selectedFileName=n.name,this.selectedFile=n):(this.fileError=!0,this.selectedFileName=null,this.selectedFile=null)}}static \u0275fac=function(t){return new(t||e)(k(E))};static \u0275cmp=V({type:e,selectors:[["app-registrar"]],viewQuery:function(t,n){if(t&1&&P(ie,5),t&2){let d;q(d=L())&&(n.fileInput=d.first)}},inputs:{solicitud:"solicitud"},decls:47,vars:19,consts:[["form","ngForm"],["numeroCuenta","ngModel"],["numeroCCI","ngModel"],["comentario","ngModel"],["fileInput",""],[1,"p-10","bg-white","rounded-lg","mx-auto"],[1,"space-y-6",3,"ngSubmit"],[1,"grid","grid-cols-1","gap-7"],[1,"block","font-medium","text-2xl","text-gray-700","mb-1"],[1,"block","text-sm","font-medium","text-gray-700","mb-1","py-4"],[1,"text-red-500"],["type","text","name","numeroCuenta","required","","pattern","^[0-9-]{13}$","placeholder","Ej: 123AA1234567289",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","transition","duration-300","text-2xl",3,"ngModelChange","ngModel"],["class","text-red-500 text-sm mt-1",4,"ngIf"],[1,"block","text-sm","font-medium","text-gray-700","mb-1"],["type","text","name","numeroCCI","required","","pattern","^[0-9-]{13,25}$","placeholder","Ej: CCI12A123A34526789",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","transition","duration-300","text-2xl",3,"ngModelChange","ngModel"],["name","comentario","required","","rows","3","placeholder","Descripci\xF3n del prop\xF3sito de la cuenta",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","transition","duration-300","text-2xl",3,"ngModelChange","ngModel"],["type","button",1,"inline-flex","justify-center","items-center","px-4","py-2","border","border-transparent","text-white","bg-blue-600","hover:bg-blue-700","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-blue-500","text-sm","font-medium","rounded-md",3,"click"],["type","file","accept",".pdf","required","",1,"hidden",3,"change"],[1,"mt-2"],["class","text-red-500 text-sm",4,"ngIf"],["class","text-green-600 text-sm",4,"ngIf"],[1,"pt-6","border-t","border-gray-200"],["type","submit",1,"inline-flex","justify-center","items-center","px-6","py-3","border","border-transparent","text-base","font-medium","rounded-md","shadow-sm","text-white","bg-[#AB4A38]","hover:bg-[#804940]","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-[#AB4A38]","transition-colors","w-full","sm:w-auto","disabled:opacity-50","disabled:cursor-not-allowed",3,"disabled"],[4,"ngIf"],[1,"text-red-500","text-sm","mt-1"],[1,"text-red-500","text-sm"],[1,"fas","fa-exclamation-circle","mr-1"],[1,"text-green-600","text-sm"],[1,"fas","fa-check-circle","mr-1"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","mr-2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 4v16m8-8H4"],[1,"fas","fa-spinner","fa-spin","mr-2"]],template:function(t,n){if(t&1){let d=D();i(0,"div",5)(1,"form",6,0),x("ngSubmit",function(){f(d);let l=p(2);return g(n.onSubmit(l))}),i(3,"div",7)(4,"div")(5,"label",8),a(6),o(),i(7,"label",9),a(8," N\xFAmero de Cuenta: "),i(9,"span",10),a(10,"*"),o()(),i(11,"input",11,1),S("ngModelChange",function(l){return f(d),y(n.cuenta.numeroCuenta,l)||(n.cuenta.numeroCuenta=l),g(l)}),o(),c(13,oe,3,2,"div",12),o(),i(14,"div")(15,"label",13),a(16," N\xFAmero CCI "),i(17,"span",10),a(18,"*"),o()(),i(19,"input",14,2),S("ngModelChange",function(l){return f(d),y(n.cuenta.numeroCCI,l)||(n.cuenta.numeroCCI=l),g(l)}),o(),c(21,se,3,2,"div",12),o(),i(22,"div")(23,"label",13),a(24," Comentario "),i(25,"span",10),a(26,"*"),o()(),i(27,"textarea",15,3),S("ngModelChange",function(l){return f(d),y(n.cuenta.comentario,l)||(n.cuenta.comentario=l),g(l)}),o(),c(29,de,2,1,"div",12),o(),i(30,"div")(31,"label",13),a(32," Adjuntar Documento (PDF) "),i(33,"span",10),a(34,"*"),o()(),i(35,"button",16),x("click",function(){return f(d),g(n.triggerFileInput())}),a(36," Seleccionar Archivo PDF "),o(),i(37,"input",17,4),x("change",function(l){return f(d),g(n.onFileChange(l))}),o(),i(39,"div",18),c(40,ue,3,0,"p",19)(41,ce,3,1,"p",20)(42,pe,3,0,"p",19),o()()(),i(43,"div",21)(44,"button",22),c(45,fe,4,0,"span",23)(46,ge,3,0,"span",23),o()()()()}if(t&2){let d=p(2),u=p(12),l=p(20),h=p(28);s(6),M(" Expediente: ",n.solicitud==null?null:n.solicitud.expediente," "),s(5),v("border-red-300",u.invalid&&u.touched),b("ngModel",n.cuenta.numeroCuenta),s(2),m("ngIf",u.invalid&&u.touched),s(6),v("border-red-300",l.invalid&&l.touched),b("ngModel",n.cuenta.numeroCCI),s(2),m("ngIf",l.invalid&&l.touched),s(6),v("border-red-300",h.invalid&&h.touched),b("ngModel",n.cuenta.comentario),s(2),m("ngIf",h.invalid&&h.touched),s(11),m("ngIf",n.fileError),s(),m("ngIf",n.selectedFileName),s(),m("ngIf",d.submitted&&!n.selectedFile),s(2),m("disabled",n.isLoading),s(),m("ngIf",!n.isLoading),s(),m("ngIf",n.isLoading)}},dependencies:[B,j,X,K,O,z,Q,U,J,G,$],encapsulation:2})};export{E as a,A as b};
